2025-05-09 20:32:30,705 [INFO] === MINECRAFT ZERO-DOWNTIME UPDATE GESTARTET (20250509_203230) ===
2025-05-09 20:32:30,706 [INFO] Release: minecraft-server, Namespace: default
2025-05-09 20:32:30,706 [INFO] SCHRITT 1/12 (8%): Prüfe Serverstatus vor dem Update
2025-05-09 20:32:30,707 [DEBUG] Verbindung zum RCON-Server 192.168.0.165:30575 wird hergestellt...
2025-05-09 20:32:30,718 [INFO] SUCCESS: RCON-Verbindung hergestellt zu 192.168.0.165:30575
2025-05-09 20:32:30,719 [DEBUG] RCON-Befehl wird gesendet: list
2025-05-09 20:32:30,747 [DEBUG] RCON-Antwort: There are 1 of a max of 20 players online: StraussRiese456
2025-05-09 20:32:30,749 [DEBUG] RCON-Verbindung getrennt
2025-05-09 20:32:30,750 [INFO] Aktuell 1 Spieler online
2025-05-09 20:32:30,751 [INFO] SCHRITT 2/12 (16%): Stelle sicher, dass Server 0 läuft
2025-05-09 20:32:30,751 [INFO] Skaliere StatefulSet minecraft-server auf 1 Replicas...
2025-05-09 20:32:30,752 [DEBUG] Ausführen: kubectl scale statefulset minecraft-server --replicas=1 -n default
2025-05-09 20:32:30,801 [DEBUG] STDOUT:
statefulset.apps/minecraft-server scaled
2025-05-09 20:32:30,802 [INFO] SUCCESS: StatefulSet auf 1 skaliert
2025-05-09 20:32:30,803 [INFO] Warte auf Bereitschaft von Pod minecraft-server-0...
2025-05-09 20:32:30,804 [DEBUG] Ausführen: kubectl wait --for=condition=ready pod/minecraft-server-0 --timeout=300s -n default
2025-05-09 20:32:30,959 [DEBUG] STDOUT:
pod/minecraft-server-0 condition met
2025-05-09 20:32:30,960 [INFO] SUCCESS: Pod minecraft-server-0 ist bereit
2025-05-09 20:32:30,961 [INFO] SCHRITT 3/12 (25%): Validiere Weltdaten vor dem Update
2025-05-09 20:32:30,961 [INFO] Validiere active Weltdaten in Pod minecraft-server-0...
2025-05-09 20:32:30,962 [DEBUG] Ausführen: kubectl exec -i minecraft-server-0 -n default -- /bin/bash -c /scripts/validate-world.sh active
2025-05-09 20:32:31,141 [DEBUG] STDOUT:
[2025-05-09 18:32:31] Starte Welt-Validierung für world
[2025-05-09 18:32:31] Validiere aktive Weltdaten in /minecraft-world/world
[2025-05-09 18:32:31] Starte Validierung der Minecraft-Welt: /minecraft-world/world
[2025-05-09 18:32:31] level.dat gefunden und hat Größe: 1554 bytes
[2025-05-09 18:32:31] Region-Dateien gefunden: 6
[2025-05-09 18:32:31] [WARNING] 2 verdächtig kleine Region-Dateien gefunden
[2025-05-09 18:32:31] Spielerdaten gefunden: 0
[2025-05-09 18:32:31] Validierung abgeschlossen:
[2025-05-09 18:32:31]   - Fehler gefunden: 0
[2025-05-09 18:32:31]   - Warnungen gefunden: 1
[2025-05-09 18:32:31] [WARNING] Weltdaten haben kleinere Probleme, sollten aber funktionieren.
[2025-05-09 18:32:31] Validierung erfolgreich abgeschlossen.
2025-05-09 20:32:31,142 [DEBUG] STDERR:
Defaulted container "minecraft-java-container" out of: minecraft-java-container, wait-for-resources (init)
2025-05-09 20:32:31,143 [INFO] SUCCESS: Weltdatenvalidierung erfolgreich
2025-05-09 20:32:31,144 [INFO] SCHRITT 4/12 (33%): Benachrichtige Spieler über bevorstehendes Update
2025-05-09 20:32:31,144 [DEBUG] Verbindung zum RCON-Server 192.168.0.165:30575 wird hergestellt...
2025-05-09 20:32:31,152 [INFO] SUCCESS: RCON-Verbindung hergestellt zu 192.168.0.165:30575
2025-05-09 20:32:31,152 [DEBUG] RCON-Befehl wird gesendet: tellraw @a {"text":"§6§lServer-Update wird vorbereitet. Update wird mit minimaler Unterbrechung durchgeführt.","color":"gold","bold":true}
2025-05-09 20:32:31,164 [DEBUG] RCON-Antwort: 
2025-05-09 20:32:31,165 [DEBUG] RCON-Befehl wird gesendet: say §6§lServer-Update wird vorbereitet. Update wird mit minimaler Unterbrechung durchgeführt.
2025-05-09 20:32:31,181 [DEBUG] RCON-Antwort: 
2025-05-09 20:32:31,182 [INFO] SUCCESS: Spielerbenachrichtigung gesendet: §6§lServer-Update wird vorbereitet. Update wird mit minimaler Unterbrechung durchgeführt.
2025-05-09 20:32:31,183 [DEBUG] RCON-Verbindung getrennt
2025-05-09 20:32:31,184 [INFO] SCHRITT 5/12 (41%): Aktualisiere Minecraft-Konfiguration mit Helm
2025-05-09 20:32:31,184 [INFO] Führe Helm-Upgrade für Release minecraft-server durch...
2025-05-09 20:32:31,185 [DEBUG] Ausführen: helm upgrade minecraft-server ./minecraft/ --set replicaCount=1 -n default
2025-05-09 20:32:31,971 [DEBUG] STDOUT:
Release "minecraft-server" has been upgraded. Happy Helming!
NAME: minecraft-server
LAST DEPLOYED: Fri May  9 20:32:31 2025
NAMESPACE: default
STATUS: deployed
REVISION: 2
TEST SUITE: None
NOTES:
Minecraft-Server wurde erfolgreich installiert!

StatefulSet: minecraft-server
Pod: minecraft-server-0
Welt-PVC: minecraft-server-world
Cash-PVC: minecraft-server-cash
Server-Eigenschaften: minecraft-server-server-properties

Um den Minecraft-Server zu steuern:
- Einschalten: kubectl scale statefulset minecraft-server --replicas=1
- Ausschalten: kubectl scale statefulset minecraft-server --replicas=0
- Updates durchführen: ./update-minecraft.sh

Verbinden mit dem Server:
- Server: <NODE_IP>:30565
- RCON: <NODE_IP>:30575

Um die Logs des Servers anzuzeigen:
  kubectl logs -f minecraft-server-0

Erfolgreiche Installation!
2025-05-09 20:32:31,972 [INFO] SUCCESS: Helm-Upgrade erfolgreich abgeschlossen
2025-05-09 20:32:31,973 [INFO] SCHRITT 6/12 (50%): Speichere aktuelle Weltdaten
2025-05-09 20:32:31,974 [DEBUG] Verbindung zum RCON-Server 192.168.0.165:30575 wird hergestellt...
2025-05-09 20:32:31,982 [INFO] SUCCESS: RCON-Verbindung hergestellt zu 192.168.0.165:30575
2025-05-09 20:32:31,983 [DEBUG] RCON-Befehl wird gesendet: tellraw @a {"text":"§6§lWeltdaten werden gespeichert...","color":"gold","bold":true}
2025-05-09 20:32:31,988 [DEBUG] RCON-Antwort: 
2025-05-09 20:32:31,989 [DEBUG] RCON-Befehl wird gesendet: say §6§lWeltdaten werden gespeichert...
2025-05-09 20:32:31,995 [DEBUG] RCON-Antwort: 
2025-05-09 20:32:31,995 [INFO] SUCCESS: Spielerbenachrichtigung gesendet: §6§lWeltdaten werden gespeichert...
2025-05-09 20:32:31,996 [DEBUG] RCON-Verbindung getrennt
2025-05-09 20:32:31,997 [DEBUG] Verbindung zum RCON-Server 192.168.0.165:30575 wird hergestellt...
2025-05-09 20:32:32,004 [INFO] SUCCESS: RCON-Verbindung hergestellt zu 192.168.0.165:30575
2025-05-09 20:32:32,005 [DEBUG] RCON-Befehl wird gesendet: save-all flush
2025-05-09 20:32:32,612 [DEBUG] RCON-Antwort: Saving the game (this may take a moment!)Saved the game
2025-05-09 20:32:32,613 [INFO] SUCCESS: Weltdaten gespeichert (save-all flush)
2025-05-09 20:32:32,613 [DEBUG] RCON-Verbindung getrennt
2025-05-09 20:32:35,614 [INFO] SCHRITT 7/12 (58%): Synchronisiere Weltdaten von Server 0 zu Backup
2025-05-09 20:32:35,617 [DEBUG] Verbindung zum RCON-Server 192.168.0.165:30575 wird hergestellt...
2025-05-09 20:32:35,624 [INFO] SUCCESS: RCON-Verbindung hergestellt zu 192.168.0.165:30575
2025-05-09 20:32:35,624 [DEBUG] RCON-Befehl wird gesendet: tellraw @a {"text":"§6§lWeltdaten werden synchronisiert...","color":"gold","bold":true}
2025-05-09 20:32:35,632 [DEBUG] RCON-Antwort: 
2025-05-09 20:32:35,633 [DEBUG] RCON-Befehl wird gesendet: say §6§lWeltdaten werden synchronisiert...
2025-05-09 20:32:35,638 [DEBUG] RCON-Antwort: 
2025-05-09 20:32:35,639 [INFO] SUCCESS: Spielerbenachrichtigung gesendet: §6§lWeltdaten werden synchronisiert...
2025-05-09 20:32:35,640 [DEBUG] RCON-Verbindung getrennt
2025-05-09 20:32:35,641 [INFO] Synchronisiere Weltdaten zum Backup für Pod minecraft-server-0...
2025-05-09 20:32:35,641 [DEBUG] Ausführen: kubectl exec -i minecraft-server-0 -n default -- /bin/bash -c /scripts/world-sync.sh to-backup
2025-05-09 20:32:36,037 [DEBUG] STDOUT:
[2025-05-09 18:32:35] Synchronisiere Weltdaten für world von Quelle zu Ziel...
[2025-05-09 18:32:35] Erstelle Notfallbackup der Welt vor Änderungen...
[2025-05-09 18:32:36] Notfallbackup erstellt: world_20250509_183235.tar.gz
[2025-05-09 18:32:36] Kopiere von dieser Welt zu Backup-Welt...
[2025-05-09 18:32:36] Kopiere Welt-Metadaten und Level-Daten...
[2025-05-09 18:32:36] Überprüfe Region-Dateien auf Integrität...
[2025-05-09 18:32:36] Weltdaten wurden erfolgreich zum Backup synchronisiert.
[2025-05-09 18:32:36] HINWEIS: Spielerdaten wurden bewusst nicht synchronisiert, um Datenverlust zu vermeiden.
[2025-05-09 18:32:36] Synchronisation abgeschlossen!
2025-05-09 20:32:36,038 [DEBUG] STDERR:
Defaulted container "minecraft-java-container" out of: minecraft-java-container, wait-for-resources (init)
tar: Removing leading `/' from member names
tar: /minecraft-world/world/region/r.-1.-1.mca: file changed as we read it
/scripts/world-sync.sh: line 34: rsync: command not found
2025-05-09 20:32:36,039 [INFO] SUCCESS: Weltsynchronisierung zum Backup abgeschlossen
2025-05-09 20:32:36,040 [INFO] Validiere backup Weltdaten in Pod minecraft-server-0...
2025-05-09 20:32:36,040 [DEBUG] Ausführen: kubectl exec -i minecraft-server-0 -n default -- /bin/bash -c /scripts/validate-world.sh backup
2025-05-09 20:32:36,171 [ERROR] Befehl fehlgeschlagen: kubectl exec -i minecraft-server-0 -n default -- /bin/bash -c /scripts/validate-world.sh backup
2025-05-09 20:32:36,172 [DEBUG] STDOUT:
[2025-05-09 18:32:36] Starte Welt-Validierung für world
[2025-05-09 18:32:36] Validiere Backup-Weltdaten in /backup-world/world
[2025-05-09 18:32:36] Starte Validierung der Minecraft-Welt: /backup-world/world
[2025-05-09 18:32:36] [ERROR] level.dat fehlt - Welt ist beschädigt
[2025-05-09 18:32:36] Region-Dateien gefunden: 4
[2025-05-09 18:32:36] [WARNING] playerdata-Verzeichnis fehlt - keine Spielerdaten vorhanden
[2025-05-09 18:32:36] [WARNING] Nether-Dimension (DIM-1) nicht gefunden
[2025-05-09 18:32:36] [WARNING] End-Dimension (DIM1) nicht gefunden
[2025-05-09 18:32:36] Validierung abgeschlossen:
[2025-05-09 18:32:36]   - Fehler gefunden: 1
[2025-05-09 18:32:36]   - Warnungen gefunden: 3
[2025-05-09 18:32:36] [ERROR] Weltdaten sind möglicherweise beschädigt!
[2025-05-09 18:32:36] [ERROR] Validierung fehlgeschlagen! Die Weltdaten könnten beschädigt sein.
2025-05-09 20:32:36,173 [DEBUG] STDERR:
Defaulted container "minecraft-java-container" out of: minecraft-java-container, wait-for-resources (init)
command terminated with exit code 1
2025-05-09 20:32:36,174 [ERROR] Fehler bei der Weltdatenvalidierung: Command '['kubectl', 'exec', '-i', 'minecraft-server-0', '-n', 'default', '--', '/bin/bash', '-c', '/scripts/validate-world.sh backup']' returned non-zero exit status 1.
2025-05-09 20:32:36,174 [ERROR] Weltdatenvalidierung nach Synchronisierung fehlgeschlagen
2025-05-09 20:32:36,175 [ERROR] Weltsynchronisierung zu Backup fehlgeschlagen
2025-05-09 20:32:36,176 [ERROR] Update nicht erfolgreich abgeschlossen. Siehe Logdatei für Details.
